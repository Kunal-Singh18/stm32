/*
 * This project is a sub project under UART communication driver development
 * Here we implement  a retargeting printf  exercise where we retarget the output of printf from console to our UART
 * */


#include  "stm32f4xx.h"
#include  <stdint.h>
#include  <stdio.h>
#include  "uart.h"
#include  "adc.h"
#include  "systick.h"
#include  "timer.h"



#define PIN12                        (1U<<12)
#define LED_PIN                      PIN12


#define GPIODEN                    (1U<<3)



int main(void)
{/*our led pin PD12 is connected to TIM4 CH1 so we need to change accordngly for this exercise.
we will make changes in timer.c*/

	RCC->AHB1ENR |=GPIODEN;


	GPIOD->MODER |= (1U<<24);
	GPIOD->MODER &= ~(1U<<25);

	 uart2_tx_init();
	 tim3_1hz_init();

	while(1)
	{
		//wait for UIF to set
		while(!(TIM3->SR &SR_UIF ))
		{}
		// clear UIF
		TIM3->SR &=~SR_UIF;

		printf("one second passed \n\r");
		GPIOD->ODR  ^=LED_PIN;

	}

}

